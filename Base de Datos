-- get Crear la base de datos --
drop database if exists tienda_plantas;
CREATE DATABASE IF NOT EXISTS tienda_plantas;
 
-- Seleccionar la base de datos
USE tienda_plantas;
 
-- Crear la tabla de usuarios
CREATE TABLE cliente (
    cliente_id INT AUTO_INCREMENT PRIMARY KEY,
    nombre_cliente VARCHAR(70) NOT NULL,
    apellido_cliente VARCHAR(70)NOT NULL,
    telefono_cliente VARCHAR(20) UNIQUE NOT NULL, 
    correo_cliente VARCHAR(100) UNIQUE  NOT NULL,
    clave_cliente VARCHAR(100) NOT NULL
);
 
-- Crear la tabla de administrador
CREATE TABLE Administrador (
    administrador_id INT AUTO_INCREMENT PRIMARY KEY,
    nombre_administrador VARCHAR(70) NOT NULL,
    apellido_administrador VARCHAR(70)NOT NULL,
    correo_administrador VARCHAR(70) NOT NULL,
    clave_administrador VARCHAR(70) NOT NULL,
    id_tipo_usuario int 
);
 
create table tipo_usuario(
id_tipo_usuario int auto_increment primary key,
nombre_tipo_usuario varchar(50)
);
 
 
-- Crear la tabla de productos
CREATE TABLE producto (
    producto_id INT AUTO_INCREMENT PRIMARY KEY,
    nombre_producto VARCHAR(255) NOT NULL,
    categoria_id INT,
    precio DECIMAL(10, 2) NOT NULL,
    cantidad_disponible INT NOT NULL
);
 
-- Crear la tabla de categoria
CREATE TABLE categoria(
categoria_id INT PRIMARY KEY AUTO_INCREMENT,
nombre_categoria VARCHAR(50),
imagen_categoria VARCHAR(70),
decripcion_categoria VARCHAR(70)
);
 
 
-- Crear la tabla de valoracion
CREATE TABLE valoracion(
id_valoracion INT NOT NULL,
id_detalle INT NOT NULL,
calificacion_producto INT NULL,
comentario_producto VARCHAR(250)NULL ,
fehca_valoracion DATE NOT NULL,
estado_comentario BOOLEAN NOT NULL
);
 
-- Crear la tabla de pedidos
CREATE TABLE pedido (
    pedido_id INT AUTO_INCREMENT PRIMARY KEY,
    estado_pedido ENUM('pendiente','entregado')NOT NULL,
    cliente_id INT NOT NULL ,
    fecha_pedido TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  direccion_pedido VARCHAR(150) NOT NULL
);
 
-- Crear la tabla de detalles del pedido
CREATE TABLE detalle_pedido (
id_detalle INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
pedido_id INT NOT NULL,
producto_id INT NOT NULL,
cantidad_producto INT NOT NULL,
precio_producto NUMERIC(5,2) NOT NULL
);
 
 
    
ALTER TABLE pedido
ADD FOREIGN KEY (cliente_id)
REFERENCES cliente(cliente_id);
 
ALTER TABLE detalle_pedido
ADD FOREIGN KEY (producto_id)
REFERENCES producto(producto_id);
 
ALTER TABLE producto
ADD FOREIGN KEY (categoria_id)
REFERENCES categoria(categoria_id);
 
ALTER TABLE valoracion
ADD FOREIGN KEY (id_detalle)
REFERENCES detalle_pedido(id_detalle);
 
ALTER TABLE detalle_pedido
ADD FOREIGN KEY (pedido_id)
REFERENCES pedido(pedido_id);
 
alter table administrador 
add foreign key (id_tipo_usuario)
references tipo_usuario(id_tipo_usuario);
